from unittest import TestCase
from g2aero.SPD import *

X_phys = [[ 1.00000800e+00, -7.10000000e-04],
       [ 9.94971356e-01, -5.42445001e-04],
       [ 9.89935193e-01, -3.61225537e-04],
       [ 9.84899323e-01, -1.71780602e-04],
       [ 9.79863559e-01,  2.05133067e-05],
       [ 9.74827778e-01,  2.12227161e-04],
       [ 9.69791934e-01,  4.02213649e-04],
       [ 9.64755989e-01,  5.89519231e-04],
       [ 9.59719930e-01,  7.73763435e-04],
       [ 9.54683756e-01,  9.54868175e-04],
       [ 9.49647470e-01,  1.13282479e-03],
       [ 9.44611084e-01,  1.30789654e-03],
       [ 9.39574609e-01,  1.48041497e-03],
       [ 9.34538055e-01,  1.65058198e-03],
       [ 9.29501419e-01,  1.81834157e-03],
       [ 9.24464701e-01,  1.98360259e-03],
       [ 9.19427895e-01,  2.14616164e-03],
       [ 9.14390992e-01,  2.30569998e-03],
       [ 9.09353987e-01,  2.46195304e-03],
       [ 9.04316889e-01,  2.61519501e-03],
       [ 8.99279717e-01,  2.76598696e-03],
       [ 8.94242483e-01,  2.91471773e-03],
       [ 8.89205180e-01,  3.06104769e-03],
       [ 8.84167793e-01,  3.20444904e-03],
       [ 8.79130313e-01,  3.34459521e-03],
       [ 8.74092746e-01,  3.48156652e-03],
       [ 8.69055097e-01,  3.61549041e-03],
       [ 8.64017371e-01,  3.74644450e-03],
       [ 8.58979568e-01,  3.87445455e-03],
       [ 8.53941692e-01,  3.99952553e-03],
       [ 8.48903739e-01,  4.12149390e-03],
       [ 8.43865707e-01,  4.24010545e-03],
       [ 8.38827592e-01,  4.35517153e-03],
       [ 8.33789399e-01,  4.46678221e-03],
       [ 8.28751135e-01,  4.57510010e-03],
       [ 8.23712802e-01,  4.68019726e-03],
       [ 8.18674401e-01,  4.78196215e-03],
       [ 8.13635931e-01,  4.88025947e-03],
       [ 8.08597391e-01,  4.97491654e-03],
       [ 8.03558780e-01,  5.06572177e-03],
       [ 7.98520099e-01,  5.15250495e-03],
       [ 7.93481354e-01,  5.23548929e-03],
       [ 7.88442554e-01,  5.31510834e-03],
       [ 7.83403706e-01,  5.39166452e-03],
       [ 7.78364810e-01,  5.46490912e-03],
       [ 7.73325861e-01,  5.53445169e-03],
       [ 7.68286858e-01,  5.60000664e-03],
       [ 7.63247805e-01,  5.66149676e-03],
       [ 7.58208702e-01,  5.71887120e-03],
       [ 7.53169554e-01,  5.77212050e-03],
       [ 7.48130365e-01,  5.82127712e-03],
       [ 7.43091138e-01,  5.86638687e-03],
       [ 7.38051878e-01,  5.90759588e-03],
       [ 7.33012589e-01,  5.94510217e-03],
       [ 7.27973274e-01,  5.97902682e-03],
       [ 7.22933935e-01,  6.00918411e-03],
       [ 7.17894574e-01,  6.03531299e-03],
       [ 7.12855192e-01,  6.05723175e-03],
       [ 7.07815794e-01,  6.07490991e-03],
       [ 7.02776383e-01,  6.08834118e-03],
       [ 6.97736963e-01,  6.09767641e-03],
       [ 6.92697537e-01,  6.10321892e-03],
       [ 6.87658109e-01,  6.10522824e-03],
       [ 6.82618680e-01,  6.10355116e-03],
       [ 6.77579254e-01,  6.09783141e-03],
       [ 6.72539835e-01,  6.08776849e-03],
       [ 6.67500427e-01,  6.07327638e-03],
       [ 6.62461034e-01,  6.05432019e-03],
       [ 6.57421659e-01,  6.03094781e-03],
       [ 6.52382305e-01,  6.00335691e-03],
       [ 6.47342975e-01,  5.97175697e-03],
       [ 6.42303671e-01,  5.93627803e-03],
       [ 6.37264396e-01,  5.89697678e-03],
       [ 6.32225151e-01,  5.85389302e-03],
       [ 6.27185941e-01,  5.80695671e-03],
       [ 6.22146769e-01,  5.75604638e-03],
       [ 6.17107640e-01,  5.70103809e-03],
       [ 6.12068559e-01,  5.64180016e-03],
       [ 6.07029531e-01,  5.57820116e-03],
       [ 6.01990560e-01,  5.51028121e-03],
       [ 5.96951644e-01,  5.43838040e-03],
       [ 5.91912781e-01,  5.36285458e-03],
       [ 5.86873973e-01,  5.28378025e-03],
       [ 5.81835224e-01,  5.20098166e-03],
       [ 5.76796541e-01,  5.11427371e-03],
       [ 5.71757930e-01,  5.02346933e-03],
       [ 5.66719398e-01,  4.92838050e-03],
       [ 5.61680951e-01,  4.82891906e-03],
       [ 5.56642587e-01,  4.72535412e-03],
       [ 5.51604300e-01,  4.61803317e-03],
       [ 5.46566091e-01,  4.50717267e-03],
       [ 5.41527961e-01,  4.39275788e-03],
       [ 5.36489914e-01,  4.27474675e-03],
       [ 5.31451955e-01,  4.15302300e-03],
       [ 5.26414093e-01,  4.02740210e-03],
       [ 5.21376332e-01,  3.89777536e-03],
       [ 5.16338662e-01,  3.76465531e-03],
       [ 5.11301063e-01,  3.62885034e-03],
       [ 5.06263522e-01,  3.49093605e-03],
       [ 5.01226047e-01,  3.35061215e-03],
       [ 4.96188656e-01,  3.20737688e-03],
       [ 4.91151353e-01,  3.06102484e-03],
       [ 4.86114131e-01,  2.91189933e-03],
       [ 4.81076980e-01,  2.76038236e-03],
       [ 4.76039904e-01,  2.60640137e-03],
       [ 4.71002921e-01,  2.44944147e-03],
       [ 4.65966046e-01,  2.28905357e-03],
       [ 4.60929272e-01,  2.12551583e-03],
       [ 4.55892579e-01,  1.95947879e-03],
       [ 4.50855953e-01,  1.79142260e-03],
       [ 4.45819404e-01,  1.62111528e-03],
       [ 4.40782945e-01,  1.44814322e-03],
       [ 4.35746586e-01,  1.27227872e-03],
       [ 4.30710323e-01,  1.09367665e-03],
       [ 4.25674151e-01,  9.12539276e-04],
       [ 4.20638064e-01,  7.29076257e-04],
       [ 4.15602053e-01,  5.43505360e-04],
       [ 4.10566114e-01,  3.56017406e-04],
       [ 4.05530249e-01,  1.66518396e-04],
       [ 4.00494471e-01, -2.52548135e-05],
       [ 3.95458787e-01, -2.19470946e-04],
       [ 3.90423185e-01, -4.15819815e-04],
       [ 3.85387649e-01, -6.13843666e-04],
       [ 3.80352168e-01, -8.13275573e-04],
       [ 3.75316752e-01, -1.01432500e-03],
       [ 3.70281412e-01, -1.21726765e-03],
       [ 3.65246149e-01, -1.42210253e-03],
       [ 3.60210947e-01, -1.62846387e-03],
       [ 3.55175794e-01, -1.83598469e-03],
       [ 3.50140686e-01, -2.04461326e-03],
       [ 3.45105631e-01, -2.25452166e-03],
       [ 3.40070635e-01, -2.46583222e-03],
       [ 3.35035690e-01, -2.67834338e-03],
       [ 3.30000782e-01, -2.89173457e-03],
       [ 3.24965901e-01, -3.10575976e-03],
       [ 3.19931045e-01, -3.32038790e-03],
       [ 3.14896216e-01, -3.53562614e-03],
       [ 3.09861412e-01, -3.75146854e-03],
       [ 3.04826633e-01, -3.96789007e-03],
       [ 2.99791878e-01, -4.18485794e-03],
       [ 2.94757141e-01, -4.40224682e-03],
       [ 2.89722413e-01, -4.61986069e-03],
       [ 2.84687688e-01, -4.83752530e-03],
       [ 2.79652964e-01, -5.05521418e-03],
       [ 2.74618242e-01, -5.27295789e-03],
       [ 2.69583521e-01, -5.49072102e-03],
       [ 2.64548791e-01, -5.70827494e-03],
       [ 2.59514041e-01, -5.92535873e-03],
       [ 2.54479266e-01, -6.14185444e-03],
       [ 2.49444468e-01, -6.35784977e-03],
       [ 2.44409654e-01, -6.57343113e-03],
       [ 2.39374814e-01, -6.78844497e-03],
       [ 2.34339937e-01, -7.00256220e-03],
       [ 2.29305009e-01, -7.21548409e-03],
       [ 2.24270026e-01, -7.42710927e-03],
       [ 2.19234988e-01, -7.63740646e-03],
       [ 2.14199890e-01, -7.84626660e-03],
       [ 2.09164719e-01, -8.05337761e-03],
       [ 2.04129463e-01, -8.25839774e-03],
       [ 1.99094113e-01, -8.46109402e-03],
       [ 1.94058666e-01, -8.66137008e-03],
       [ 1.89023118e-01, -8.85911758e-03],
       [ 1.83987459e-01, -9.05400324e-03],
       [ 1.78951673e-01, -9.24555555e-03],
       [ 1.73915742e-01, -9.43331434e-03],
       [ 1.68879658e-01, -9.61687951e-03],
       [ 1.63843408e-01, -9.79586794e-03],
       [ 1.58806985e-01, -9.96990162e-03],
       [ 1.53770380e-01, -1.01386127e-02],
       [ 1.48733587e-01, -1.03016276e-02],
       [ 1.43696596e-01, -1.04584304e-02],
       [ 1.38659397e-01, -1.06083737e-02],
       [ 1.33621979e-01, -1.07508072e-02],
       [ 1.28584337e-01, -1.08850915e-02],
       [ 1.23546467e-01, -1.10105922e-02],
       [ 1.18508369e-01, -1.11265891e-02],
       [ 1.13470040e-01, -1.12321265e-02],
       [ 1.08431482e-01, -1.13262022e-02],
       [ 1.03392702e-01, -1.14075968e-02],
       [ 9.83537127e-02, -1.14748397e-02],
       [ 9.33145338e-02, -1.15264234e-02],
       [ 8.82752059e-02, -1.15606549e-02],
       [ 8.32357810e-02, -1.15757516e-02],
       [ 7.81963278e-02, -1.15697004e-02],
       [ 7.31569615e-02, -1.15398454e-02],
       [ 6.81178084e-02, -1.14833971e-02],
       [ 6.30790698e-02, -1.13970370e-02],
       [ 5.80410223e-02, -1.12769147e-02],
       [ 5.30039880e-02, -1.11188781e-02],
       [ 4.79685083e-02, -1.09173368e-02],
       [ 4.29352058e-02, -1.06661649e-02],
       [ 3.79051364e-02, -1.03564454e-02],
       [ 3.28799182e-02, -9.97563455e-03],
       [ 2.78618896e-02, -9.50777021e-03],
       [ 2.28558877e-02, -8.92526038e-03],
       [ 1.78693475e-02, -8.19211645e-03],
       [ 1.29192869e-02, -7.24541785e-03],
       [ 8.04110005e-03, -5.98024878e-03],
       [ 3.35638236e-03, -4.13502569e-03],
       [ 4.60905992e-05, -5.56566603e-04],
       [ 1.63161164e-03,  4.12038980e-03],
       [ 4.96948962e-03,  7.88719321e-03],
       [ 8.88225496e-03,  1.10617436e-02],
       [ 1.31034061e-02,  1.38163607e-02],
       [ 1.75154599e-02,  1.62542037e-02],
       [ 2.20574409e-02,  1.84398895e-02],
       [ 2.66942301e-02,  2.04171096e-02],
       [ 3.14007611e-02,  2.22207382e-02],
       [ 3.61618161e-02,  2.38748562e-02],
       [ 4.09656260e-02,  2.53997265e-02],
       [ 4.58037108e-02,  2.68115660e-02],
       [ 5.06697157e-02,  2.81239720e-02],
       [ 5.55583275e-02,  2.93487382e-02],
       [ 6.04660814e-02,  3.04944251e-02],
       [ 6.53898295e-02,  3.15689792e-02],
       [ 7.03273297e-02,  3.25783021e-02],
       [ 7.52767599e-02,  3.35273496e-02],
       [ 8.02364884e-02,  3.44207528e-02],
       [ 8.52052456e-02,  3.52625285e-02],
       [ 9.01818252e-02,  3.60565758e-02],
       [ 9.51652627e-02,  3.68062658e-02],
       [ 1.00154745e-01,  3.75146413e-02],
       [ 1.05149527e-01,  3.81844727e-02],
       [ 1.10149080e-01,  3.88176783e-02],
       [ 1.15152917e-01,  3.94160086e-02],
       [ 1.20160591e-01,  3.99812700e-02],
       [ 1.25171692e-01,  4.05153320e-02],
       [ 1.30185828e-01,  4.10200142e-02],
       [ 1.35202693e-01,  4.14967444e-02],
       [ 1.40222022e-01,  4.19467764e-02],
       [ 1.45243566e-01,  4.23713137e-02],
       [ 1.50267115e-01,  4.27714303e-02],
       [ 1.55292469e-01,  4.31481767e-02],
       [ 1.60319445e-01,  4.35025447e-02],
       [ 1.65347889e-01,  4.38354627e-02],
       [ 1.70377646e-01,  4.41478441e-02],
       [ 1.75408588e-01,  4.44405099e-02],
       [ 1.80440595e-01,  4.47142385e-02],
       [ 1.85473554e-01,  4.49698062e-02],
       [ 1.90507366e-01,  4.52079847e-02],
       [ 1.95541936e-01,  4.54295411e-02],
       [ 2.00577183e-01,  4.56350998e-02],
       [ 2.05613041e-01,  4.58250977e-02],
       [ 2.10649444e-01,  4.59999769e-02],
       [ 2.15686328e-01,  4.61603743e-02],
       [ 2.20723633e-01,  4.63070455e-02],
       [ 2.25761298e-01,  4.64406803e-02],
       [ 2.30799281e-01,  4.65616828e-02],
       [ 2.35837544e-01,  4.66703819e-02],
       [ 2.40876048e-01,  4.67671834e-02],
       [ 2.45914759e-01,  4.68526378e-02],
       [ 2.50953641e-01,  4.69273004e-02],
       [ 2.55992666e-01,  4.69915138e-02],
       [ 2.61031810e-01,  4.70454316e-02],
       [ 2.66071053e-01,  4.70892267e-02],
       [ 2.71110371e-01,  4.71232536e-02],
       [ 2.76149743e-01,  4.71479434e-02],
       [ 2.81189151e-01,  4.71636966e-02],
       [ 2.86228578e-01,  4.71708204e-02],
       [ 2.91268010e-01,  4.71696015e-02],
       [ 2.96307433e-01,  4.71601848e-02],
       [ 3.01346834e-01,  4.71425141e-02],
       [ 3.06386197e-01,  4.71165486e-02],
       [ 3.11425513e-01,  4.70826498e-02],
       [ 3.16464777e-01,  4.70414615e-02],
       [ 3.21503981e-01,  4.69934987e-02],
       [ 3.26543113e-01,  4.69385513e-02],
       [ 3.31582156e-01,  4.68761663e-02],
       [ 3.36621099e-01,  4.68061716e-02],
       [ 3.41659941e-01,  4.67290872e-02],
       [ 3.46698680e-01,  4.66455265e-02],
       [ 3.51737311e-01,  4.65557356e-02],
       [ 3.56775822e-01,  4.64595165e-02],
       [ 3.61814202e-01,  4.63566700e-02],
       [ 3.66852445e-01,  4.62472736e-02],
       [ 3.71890547e-01,  4.61315736e-02],
       [ 3.76928506e-01,  4.60097995e-02],
       [ 3.81966317e-01,  4.58820885e-02],
       [ 3.87003977e-01,  4.57485507e-02],
       [ 3.92041482e-01,  4.56092599e-02],
       [ 3.97078824e-01,  4.54642100e-02],
       [ 4.02115996e-01,  4.53133828e-02],
       [ 4.07152991e-01,  4.51567361e-02],
       [ 4.12189799e-01,  4.49941997e-02],
       [ 4.17226412e-01,  4.48257405e-02],
       [ 4.22262835e-01,  4.46517059e-02],
       [ 4.27299084e-01,  4.44726621e-02],
       [ 4.32335166e-01,  4.42889944e-02],
       [ 4.37371061e-01,  4.41002712e-02],
       [ 4.42406737e-01,  4.39058348e-02],
       [ 4.47442178e-01,  4.37053974e-02],
       [ 4.52477399e-01,  4.34994645e-02],
       [ 4.57512417e-01,  4.32886275e-02],
       [ 4.62547233e-01,  4.30730215e-02],
       [ 4.67581825e-01,  4.28522801e-02],
       [ 4.72616173e-01,  4.26260650e-02],
       [ 4.77650283e-01,  4.23945679e-02],
       [ 4.82684170e-01,  4.21582822e-02],
       [ 4.87717848e-01,  4.19175662e-02],
       [ 4.92751299e-01,  4.16721558e-02],
       [ 4.97784495e-01,  4.14216133e-02],
       [ 5.02817423e-01,  4.11657168e-02],
       [ 5.07850090e-01,  4.09047165e-02],
       [ 5.12882505e-01,  4.06389213e-02],
       [ 5.17914675e-01,  4.03685374e-02],
       [ 5.22946602e-01,  4.00936544e-02],
       [ 5.27978285e-01,  3.98143349e-02],
       [ 5.33009710e-01,  3.95304234e-02],
       [ 5.38040858e-01,  3.92416355e-02],
       [ 5.43071712e-01,  3.89477934e-02],
       [ 5.48102290e-01,  3.86492335e-02],
       [ 5.53132615e-01,  3.83464434e-02],
       [ 5.58162700e-01,  3.80396856e-02],
       [ 5.63192524e-01,  3.77286984e-02],
       [ 5.68222063e-01,  3.74131554e-02],
       [ 5.73251314e-01,  3.70930312e-02],
       [ 5.78280294e-01,  3.67686636e-02],
       [ 5.83309020e-01,  3.64403849e-02],
       [ 5.88337490e-01,  3.61082163e-02],
       [ 5.93365689e-01,  3.57719809e-02],
       [ 5.98393606e-01,  3.54315562e-02],
       [ 6.03421250e-01,  3.50871214e-02],
       [ 6.08448638e-01,  3.47389535e-02],
       [ 6.13475774e-01,  3.43871593e-02],
       [ 6.18502630e-01,  3.40314107e-02],
       [ 6.23529176e-01,  3.36713233e-02],
       [ 6.28555420e-01,  3.33070312e-02],
       [ 6.33581419e-01,  3.29393560e-02],
       [ 6.38607228e-01,  3.25690842e-02],
       [ 6.43632821e-01,  3.21959058e-02],
       [ 6.48658114e-01,  3.18187332e-02],
       [ 6.53683039e-01,  3.14366743e-02],
       [ 6.58707619e-01,  3.10500965e-02],
       [ 6.63731914e-01,  3.06598313e-02],
       [ 6.68755980e-01,  3.02666409e-02],
       [ 6.73779861e-01,  2.98710858e-02],
       [ 6.78803595e-01,  2.94736833e-02],
       [ 6.83827197e-01,  2.90746029e-02],
       [ 6.88850637e-01,  2.86734914e-02],
       [ 6.93873884e-01,  2.82699781e-02],
       [ 6.98896941e-01,  2.78641057e-02],
       [ 7.03919838e-01,  2.74562506e-02],
       [ 7.08942603e-01,  2.70467703e-02],
       [ 7.13965247e-01,  2.66358246e-02],
       [ 7.18987778e-01,  2.62234888e-02],
       [ 7.24010193e-01,  2.58097450e-02],
       [ 7.29032465e-01,  2.53942589e-02],
       [ 7.34054558e-01,  2.49766316e-02],
       [ 7.39076460e-01,  2.45567078e-02],
       [ 7.44098193e-01,  2.41347558e-02],
       [ 7.49119780e-01,  2.37110776e-02],
       [ 7.54141231e-01,  2.32858001e-02],
       [ 7.59162544e-01,  2.28588860e-02],
       [ 7.64183714e-01,  2.24302990e-02],
       [ 7.69204743e-01,  2.20000643e-02],
       [ 7.74225636e-01,  2.15682377e-02],
       [ 7.79246390e-01,  2.11348042e-02],
       [ 7.84266980e-01,  2.06994634e-02],
       [ 7.89287370e-01,  2.02618441e-02],
       [ 7.94307550e-01,  1.98218039e-02],
       [ 7.99327545e-01,  1.93796659e-02],
       [ 8.04347388e-01,  1.89357955e-02],
       [ 8.09367075e-01,  1.84901745e-02],
       [ 8.14386568e-01,  1.80423686e-02],
       [ 8.19405831e-01,  1.75920061e-02],
       [ 8.24424908e-01,  1.71395687e-02],
       [ 8.29443887e-01,  1.66860366e-02],
       [ 8.34462830e-01,  1.62321043e-02],
       [ 8.39481672e-01,  1.57770575e-02],
       [ 8.44500308e-01,  1.53197604e-02],
       [ 8.49518689e-01,  1.48596672e-02],
       [ 8.54536894e-01,  1.43976542e-02],
       [ 8.59555021e-01,  1.39347896e-02],
       [ 8.64573106e-01,  1.34714785e-02],
       [ 8.69591109e-01,  1.30072797e-02],
       [ 8.74608987e-01,  1.25417279e-02],
       [ 8.79626733e-01,  1.20747560e-02],
       [ 8.84644366e-01,  1.16065727e-02],
       [ 8.89661901e-01,  1.11373452e-02],
       [ 8.94679329e-01,  1.06669657e-02],
       [ 8.99696629e-01,  1.01952261e-02],
       [ 9.04713793e-01,  9.72205298e-03],
       [ 9.09730853e-01,  9.24776686e-03],
       [ 9.14747845e-01,  8.77275189e-03],
       [ 9.19764759e-01,  8.29691825e-03],
       [ 9.24781516e-01,  7.81944910e-03],
       [ 9.29798036e-01,  7.33950883e-03],
       [ 9.34814309e-01,  6.85698932e-03],
       [ 9.39830386e-01,  6.37238970e-03],
       [ 9.44846284e-01,  5.88589550e-03],
       [ 9.49861775e-01,  5.39524878e-03],
       [ 9.54876516e-01,  4.89710117e-03],
       [ 9.59890325e-01,  4.38966774e-03],
       [ 9.64903595e-01,  3.87683670e-03],
       [ 9.69916842e-01,  3.36374037e-03],
       [ 9.74930209e-01,  2.85183206e-03],
       [ 9.79943152e-01,  2.33587073e-03],
       [ 9.84955110e-01,  1.81044874e-03],
       [ 9.89966464e-01,  1.27921154e-03],
       [ 9.94978368e-01,  7.53280257e-04],
       [ 9.99992000e-01,  2.44000000e-04]]
Y_phys = [[ 1.00000000e+00,  0.00000000e+00],
       [ 9.94891868e-01, -2.98248221e-04],
       [ 9.89783543e-01, -5.93616471e-04],
       [ 9.84675023e-01, -8.85970130e-04],
       [ 9.79566307e-01, -1.17517457e-03],
       [ 9.74457392e-01, -1.46109518e-03],
       [ 9.69348277e-01, -1.74359732e-03],
       [ 9.64238959e-01, -2.02254639e-03],
       [ 9.59129437e-01, -2.29780774e-03],
       [ 9.54019708e-01, -2.56924677e-03],
       [ 9.48909771e-01, -2.83672885e-03],
       [ 9.43799623e-01, -3.10011936e-03],
       [ 9.38689263e-01, -3.35928367e-03],
       [ 9.33578688e-01, -3.61408716e-03],
       [ 9.28467897e-01, -3.86439522e-03],
       [ 9.23356888e-01, -4.11007321e-03],
       [ 9.18245658e-01, -4.35098651e-03],
       [ 9.13134206e-01, -4.58700051e-03],
       [ 9.08022530e-01, -4.81798057e-03],
       [ 9.02910627e-01, -5.04379208e-03],
       [ 8.97798496e-01, -5.26430428e-03],
       [ 8.92686140e-01, -5.47951254e-03],
       [ 8.87573567e-01, -5.68956340e-03],
       [ 8.82460787e-01, -5.89461236e-03],
       [ 8.77347809e-01, -6.09481490e-03],
       [ 8.72234641e-01, -6.29032648e-03],
       [ 8.67121292e-01, -6.48130261e-03],
       [ 8.62007773e-01, -6.66789875e-03],
       [ 8.56894091e-01, -6.85027039e-03],
       [ 8.51780256e-01, -7.02857300e-03],
       [ 8.46666277e-01, -7.20296208e-03],
       [ 8.41552162e-01, -7.37359310e-03],
       [ 8.36437922e-01, -7.54062153e-03],
       [ 8.31323564e-01, -7.70420287e-03],
       [ 8.26209099e-01, -7.86449260e-03],
       [ 8.21094534e-01, -8.02164618e-03],
       [ 8.15979879e-01, -8.17581911e-03],
       [ 8.10865144e-01, -8.32716687e-03],
       [ 8.05750336e-01, -8.47584493e-03],
       [ 8.00635466e-01, -8.62200878e-03],
       [ 7.95520541e-01, -8.76581347e-03],
       [ 7.90405566e-01, -8.90741158e-03],
       [ 7.85290545e-01, -9.04695477e-03],
       [ 7.80175481e-01, -9.18459473e-03],
       [ 7.75060378e-01, -9.32048313e-03],
       [ 7.69945239e-01, -9.45477163e-03],
       [ 7.64830067e-01, -9.58761193e-03],
       [ 7.59714866e-01, -9.71915568e-03],
       [ 7.54599639e-01, -9.84955456e-03],
       [ 7.49484390e-01, -9.97896025e-03],
       [ 7.44369121e-01, -1.01075244e-02],
       [ 7.39253838e-01, -1.02353987e-02],
       [ 7.34138542e-01, -1.03627349e-02],
       [ 7.29023237e-01, -1.04896846e-02],
       [ 7.23907927e-01, -1.06163994e-02],
       [ 7.18792616e-01, -1.07430311e-02],
       [ 7.13677305e-01, -1.08697313e-02],
       [ 7.08562000e-01, -1.09966517e-02],
       [ 7.03446703e-01, -1.11239440e-02],
       [ 6.98331418e-01, -1.12517587e-02],
       [ 6.93216147e-01, -1.13801762e-02],
       [ 6.88100888e-01, -1.15091659e-02],
       [ 6.82985642e-01, -1.16386874e-02],
       [ 6.77870406e-01, -1.17687004e-02],
       [ 6.72755181e-01, -1.18991644e-02],
       [ 6.67639965e-01, -1.20300392e-02],
       [ 6.62524757e-01, -1.21612842e-02],
       [ 6.57409557e-01, -1.22928593e-02],
       [ 6.52294363e-01, -1.24247239e-02],
       [ 6.47179175e-01, -1.25568377e-02],
       [ 6.42063992e-01, -1.26891603e-02],
       [ 6.36948812e-01, -1.28216514e-02],
       [ 6.31833635e-01, -1.29542706e-02],
       [ 6.26718460e-01, -1.30869774e-02],
       [ 6.21603286e-01, -1.32197316e-02],
       [ 6.16488112e-01, -1.33524928e-02],
       [ 6.11372938e-01, -1.34852205e-02],
       [ 6.06257761e-01, -1.36178744e-02],
       [ 6.01142582e-01, -1.37504142e-02],
       [ 5.96027400e-01, -1.38828033e-02],
       [ 5.90912214e-01, -1.40150366e-02],
       [ 5.85797025e-01, -1.41471238e-02],
       [ 5.80681832e-01, -1.42790747e-02],
       [ 5.75566637e-01, -1.44108991e-02],
       [ 5.70451439e-01, -1.45426069e-02],
       [ 5.65336239e-01, -1.46742079e-02],
       [ 5.60221036e-01, -1.48057119e-02],
       [ 5.55105832e-01, -1.49371288e-02],
       [ 5.49990626e-01, -1.50684683e-02],
       [ 5.44875419e-01, -1.51997403e-02],
       [ 5.39760210e-01, -1.53309546e-02],
       [ 5.34645000e-01, -1.54621211e-02],
       [ 5.29529790e-01, -1.55932496e-02],
       [ 5.24414579e-01, -1.57243498e-02],
       [ 5.19299368e-01, -1.58554317e-02],
       [ 5.14184157e-01, -1.59865050e-02],
       [ 5.09068946e-01, -1.61175795e-02],
       [ 5.03953736e-01, -1.62486652e-02],
       [ 4.98838526e-01, -1.63797718e-02],
       [ 4.93723318e-01, -1.65109064e-02],
       [ 4.88608110e-01, -1.66420709e-02],
       [ 4.83492902e-01, -1.67732663e-02],
       [ 4.78377696e-01, -1.69044936e-02],
       [ 4.73262490e-01, -1.70357540e-02],
       [ 4.68147285e-01, -1.71670486e-02],
       [ 4.63032081e-01, -1.72983783e-02],
       [ 4.57916877e-01, -1.74297444e-02],
       [ 4.52801674e-01, -1.75611477e-02],
       [ 4.47686472e-01, -1.76925895e-02],
       [ 4.42571270e-01, -1.78240708e-02],
       [ 4.37456068e-01, -1.79555927e-02],
       [ 4.32340868e-01, -1.80871562e-02],
       [ 4.27225667e-01, -1.82187624e-02],
       [ 4.22110467e-01, -1.83504125e-02],
       [ 4.16995267e-01, -1.84821074e-02],
       [ 4.11880068e-01, -1.86138482e-02],
       [ 4.06764869e-01, -1.87456361e-02],
       [ 4.01649670e-01, -1.88774720e-02],
       [ 3.96534472e-01, -1.90093563e-02],
       [ 3.91419273e-01, -1.91412805e-02],
       [ 3.86304075e-01, -1.92732305e-02],
       [ 3.81188877e-01, -1.94051922e-02],
       [ 3.76073678e-01, -1.95371515e-02],
       [ 3.70958479e-01, -1.96690942e-02],
       [ 3.65843280e-01, -1.98010063e-02],
       [ 3.60728081e-01, -1.99328736e-02],
       [ 3.55612880e-01, -2.00646820e-02],
       [ 3.50497680e-01, -2.01964174e-02],
       [ 3.45382478e-01, -2.03280656e-02],
       [ 3.40267275e-01, -2.04596125e-02],
       [ 3.35152072e-01, -2.05910441e-02],
       [ 3.30036867e-01, -2.07223461e-02],
       [ 3.24921662e-01, -2.08535045e-02],
       [ 3.19806454e-01, -2.09845051e-02],
       [ 3.14691246e-01, -2.11153339e-02],
       [ 3.09576036e-01, -2.12459766e-02],
       [ 3.04460824e-01, -2.13764193e-02],
       [ 2.99345611e-01, -2.15066477e-02],
       [ 2.94230396e-01, -2.16366798e-02],
       [ 2.89115179e-01, -2.17666207e-02],
       [ 2.83999962e-01, -2.18965903e-02],
       [ 2.78884744e-01, -2.20267089e-02],
       [ 2.73769526e-01, -2.21570963e-02],
       [ 2.68654309e-01, -2.22878725e-02],
       [ 2.63539092e-01, -2.24191576e-02],
       [ 2.58423877e-01, -2.25510717e-02],
       [ 2.53308663e-01, -2.26837346e-02],
       [ 2.48193452e-01, -2.28172627e-02],
       [ 2.43078243e-01, -2.29515739e-02],
       [ 2.37963037e-01, -2.30862946e-02],
       [ 2.32847835e-01, -2.32210282e-02],
       [ 2.27732638e-01, -2.33553779e-02],
       [ 2.22617446e-01, -2.34889467e-02],
       [ 2.17502259e-01, -2.36213379e-02],
       [ 2.12387079e-01, -2.37521548e-02],
       [ 2.07271905e-01, -2.38810004e-02],
       [ 2.02156738e-01, -2.40074781e-02],
       [ 1.97041580e-01, -2.41312469e-02],
       [ 1.91926426e-01, -2.42528797e-02],
       [ 1.86811270e-01, -2.43736934e-02],
       [ 1.81696108e-01, -2.44950270e-02],
       [ 1.76580931e-01, -2.46182191e-02],
       [ 1.71465735e-01, -2.47446087e-02],
       [ 1.66350513e-01, -2.48755344e-02],
       [ 1.61235259e-01, -2.50123351e-02],
       [ 1.56119966e-01, -2.51563496e-02],
       [ 1.51004630e-01, -2.53089167e-02],
       [ 1.45889247e-01, -2.54708416e-02],
       [ 1.40773833e-01, -2.56390317e-02],
       [ 1.35658418e-01, -2.58086647e-02],
       [ 1.30543027e-01, -2.59749108e-02],
       [ 1.25427687e-01, -2.61329400e-02],
       [ 1.20312427e-01, -2.62779223e-02],
       [ 1.15197272e-01, -2.64050279e-02],
       [ 1.10082251e-01, -2.65094267e-02],
       [ 1.04967389e-01, -2.65862888e-02],
       [ 9.98527155e-02, -2.66307844e-02],
       [ 9.47381265e-02, -2.66403288e-02],
       [ 8.96230448e-02, -2.66205757e-02],
       [ 8.45067838e-02, -2.65790682e-02],
       [ 7.93886568e-02, -2.65233490e-02],
       [ 7.42679796e-02, -2.64609390e-02],
       [ 6.91452922e-02, -2.63881453e-02],
       [ 6.40243456e-02, -2.62718552e-02],
       [ 5.89094114e-02, -2.60741900e-02],
       [ 5.38047612e-02, -2.57572707e-02],
       [ 4.87146557e-02, -2.52833848e-02],
       [ 4.36420947e-02, -2.46343930e-02],
       [ 3.85876479e-02, -2.38298756e-02],
       [ 3.35516081e-02, -2.28937056e-02],
       [ 2.85342685e-02, -2.18497562e-02],
       [ 2.35364077e-02, -2.07201811e-02],
       [ 1.85984896e-02, -1.93866060e-02],
       [ 1.38294743e-02, -1.74881085e-02],
       [ 9.35649673e-03, -1.46771172e-02],
       [ 5.41972381e-03, -1.09774294e-02],
       [ 2.32401901e-03, -6.62540317e-03],
       [ 3.75008112e-04, -1.85990139e-03],
       [-1.44470285e-04,  3.08505713e-03],
       [ 7.35446064e-04,  8.04198491e-03],
       [ 2.75724661e-03,  1.28917285e-02],
       [ 5.65830419e-03,  1.75162222e-02],
       [ 9.17599165e-03,  2.17974001e-02],
       [ 1.30477872e-02,  2.56173312e-02],
       [ 1.70692314e-02,  2.89322973e-02],
       [ 2.11901379e-02,  3.18957646e-02],
       [ 2.53856609e-02,  3.46935579e-02],
       [ 2.96366572e-02,  3.74659896e-02],
       [ 3.39413631e-02,  4.02146598e-02],
       [ 3.83013137e-02,  4.29148370e-02],
       [ 4.27180445e-02,  4.55417900e-02],
       [ 4.71930908e-02,  4.80707874e-02],
       [ 5.17279135e-02,  5.04774424e-02],
       [ 5.63206992e-02,  5.27525489e-02],
       [ 6.09651446e-02,  5.49077175e-02],
       [ 6.56546209e-02,  5.69560661e-02],
       [ 7.03824996e-02,  5.89107127e-02],
       [ 7.51421521e-02,  6.07847751e-02],
       [ 7.99275844e-02,  6.25906712e-02],
       [ 8.47351240e-02,  6.43382578e-02],
       [ 8.95616291e-02,  6.60368062e-02],
       [ 9.44039579e-02,  6.76955874e-02],
       [ 9.92589687e-02,  6.93238728e-02],
       [ 1.04123941e-01,  7.09292570e-02],
       [ 1.08998833e-01,  7.25086748e-02],
       [ 1.13884654e-01,  7.40548851e-02],
       [ 1.18782413e-01,  7.55606373e-02],
       [ 1.23693120e-01,  7.70186804e-02],
       [ 1.28617787e-01,  7.84217638e-02],
       [ 1.33557424e-01,  7.97626367e-02],
       [ 1.38513041e-01,  8.10340484e-02],
       [ 1.43485648e-01,  8.22287480e-02],
       [ 1.48476256e-01,  8.33394849e-02],
       [ 1.53485708e-01,  8.43598297e-02],
       [ 1.58513096e-01,  8.52919693e-02],
       [ 1.63556464e-01,  8.61432372e-02],
       [ 1.68613843e-01,  8.69210356e-02],
       [ 1.73683263e-01,  8.76327669e-02],
       [ 1.78762757e-01,  8.82858336e-02],
       [ 1.83850353e-01,  8.88876379e-02],
       [ 1.88944083e-01,  8.94455821e-02],
       [ 1.94041978e-01,  8.99670688e-02],
       [ 1.99142069e-01,  9.04595001e-02],
       [ 2.04242592e-01,  9.09295609e-02],
       [ 2.09343172e-01,  9.13791419e-02],
       [ 2.14443997e-01,  9.18081699e-02],
       [ 2.19545259e-01,  9.22165656e-02],
       [ 2.24647149e-01,  9.26042496e-02],
       [ 2.29749859e-01,  9.29711427e-02],
       [ 2.34853580e-01,  9.33171656e-02],
       [ 2.39958503e-01,  9.36422390e-02],
       [ 2.45064819e-01,  9.39462836e-02],
       [ 2.50172721e-01,  9.42292202e-02],
       [ 2.55282329e-01,  9.44909045e-02],
       [ 2.60393509e-01,  9.47309575e-02],
       [ 2.65506070e-01,  9.49489473e-02],
       [ 2.70619822e-01,  9.51444419e-02],
       [ 2.75734574e-01,  9.53170092e-02],
       [ 2.80850133e-01,  9.54662174e-02],
       [ 2.85966310e-01,  9.55916343e-02],
       [ 2.91082913e-01,  9.56928280e-02],
       [ 2.96199751e-01,  9.57693666e-02],
       [ 3.01316633e-01,  9.58208221e-02],
       [ 3.06433427e-01,  9.58472231e-02],
       [ 3.11550103e-01,  9.58494678e-02],
       [ 3.16666650e-01,  9.58285514e-02],
       [ 3.21783050e-01,  9.57854696e-02],
       [ 3.26899291e-01,  9.57212177e-02],
       [ 3.32015358e-01,  9.56367913e-02],
       [ 3.37131235e-01,  9.55331856e-02],
       [ 3.42246908e-01,  9.54113963e-02],
       [ 3.47362364e-01,  9.52724187e-02],
       [ 3.52477586e-01,  9.51172483e-02],
       [ 3.57592561e-01,  9.49468805e-02],
       [ 3.62707273e-01,  9.47623109e-02],
       [ 3.67821709e-01,  9.45645347e-02],
       [ 3.72935854e-01,  9.43545476e-02],
       [ 3.78049693e-01,  9.41333450e-02],
       [ 3.83163212e-01,  9.39019222e-02],
       [ 3.88276395e-01,  9.36612748e-02],
       [ 3.93389229e-01,  9.34123982e-02],
       [ 3.98501699e-01,  9.31562878e-02],
       [ 4.03613787e-01,  9.28938490e-02],
       [ 4.08725450e-01,  9.26250778e-02],
       [ 4.13836630e-01,  9.23494440e-02],
       [ 4.18947267e-01,  9.20664110e-02],
       [ 4.24057302e-01,  9.17754422e-02],
       [ 4.29166677e-01,  9.14760008e-02],
       [ 4.34275333e-01,  9.11675503e-02],
       [ 4.39383210e-01,  9.08495539e-02],
       [ 4.44490250e-01,  9.05214751e-02],
       [ 4.49596394e-01,  9.01827772e-02],
       [ 4.54701582e-01,  8.98329235e-02],
       [ 4.59805757e-01,  8.94713774e-02],
       [ 4.64908858e-01,  8.90976022e-02],
       [ 4.70010827e-01,  8.87110614e-02],
       [ 4.75111606e-01,  8.83112181e-02],
       [ 4.80211134e-01,  8.78975358e-02],
       [ 4.85309354e-01,  8.74694779e-02],
       [ 4.90406206e-01,  8.70265077e-02],
       [ 4.95501632e-01,  8.65680885e-02],
       [ 5.00595571e-01,  8.60936840e-02],
       [ 5.05687994e-01,  8.56030484e-02],
       [ 5.10778945e-01,  8.50967575e-02],
       [ 5.15868484e-01,  8.45755312e-02],
       [ 5.20956670e-01,  8.40400896e-02],
       [ 5.26043561e-01,  8.34911526e-02],
       [ 5.31129218e-01,  8.29294402e-02],
       [ 5.36213700e-01,  8.23556724e-02],
       [ 5.41297064e-01,  8.17705691e-02],
       [ 5.46379372e-01,  8.11748504e-02],
       [ 5.51460682e-01,  8.05692362e-02],
       [ 5.56541052e-01,  7.99544466e-02],
       [ 5.61620543e-01,  7.93312015e-02],
       [ 5.66699214e-01,  7.87002208e-02],
       [ 5.71777123e-01,  7.80622247e-02],
       [ 5.76854330e-01,  7.74179330e-02],
       [ 5.81930894e-01,  7.67680658e-02],
       [ 5.87006874e-01,  7.61133429e-02],
       [ 5.92082330e-01,  7.54544846e-02],
       [ 5.97157320e-01,  7.47922106e-02],
       [ 6.02231903e-01,  7.41272246e-02],
       [ 6.07306079e-01,  7.34597219e-02],
       [ 6.12379787e-01,  7.27893027e-02],
       [ 6.17452959e-01,  7.21155336e-02],
       [ 6.22525530e-01,  7.14379811e-02],
       [ 6.27597433e-01,  7.07562117e-02],
       [ 6.32668601e-01,  7.00697919e-02],
       [ 6.37738968e-01,  6.93782882e-02],
       [ 6.42808468e-01,  6.86812672e-02],
       [ 6.47877034e-01,  6.79782953e-02],
       [ 6.52944599e-01,  6.72689391e-02],
       [ 6.58011098e-01,  6.65527651e-02],
       [ 6.63076464e-01,  6.58293398e-02],
       [ 6.68140630e-01,  6.50982296e-02],
       [ 6.73203529e-01,  6.43590012e-02],
       [ 6.78265097e-01,  6.36112211e-02],
       [ 6.83325265e-01,  6.28544557e-02],
       [ 6.88383968e-01,  6.20882716e-02],
       [ 6.93441138e-01,  6.13122352e-02],
       [ 6.98496711e-01,  6.05259132e-02],
       [ 7.03550628e-01,  5.97289309e-02],
       [ 7.08602923e-01,  5.89215169e-02],
       [ 7.13653687e-01,  5.81042533e-02],
       [ 7.18703009e-01,  5.72777264e-02],
       [ 7.23750979e-01,  5.64425227e-02],
       [ 7.28797685e-01,  5.55992285e-02],
       [ 7.33843219e-01,  5.47484302e-02],
       [ 7.38887670e-01,  5.38907144e-02],
       [ 7.43931127e-01,  5.30266673e-02],
       [ 7.48973680e-01,  5.21568755e-02],
       [ 7.54015419e-01,  5.12819253e-02],
       [ 7.59056433e-01,  5.04024031e-02],
       [ 7.64096813e-01,  4.95188954e-02],
       [ 7.69136647e-01,  4.86319886e-02],
       [ 7.74176027e-01,  4.77422691e-02],
       [ 7.79215041e-01,  4.68503233e-02],
       [ 7.84253779e-01,  4.59567376e-02],
       [ 7.89292330e-01,  4.50620984e-02],
       [ 7.94330786e-01,  4.41669922e-02],
       [ 7.99369234e-01,  4.32720054e-02],
       [ 8.04407747e-01,  4.23776067e-02],
       [ 8.09446280e-01,  4.14835774e-02],
       [ 8.14484751e-01,  4.05894497e-02],
       [ 8.19523076e-01,  3.96947556e-02],
       [ 8.24561171e-01,  3.87990270e-02],
       [ 8.29598954e-01,  3.79017958e-02],
       [ 8.34636340e-01,  3.70025939e-02],
       [ 8.39673246e-01,  3.61009533e-02],
       [ 8.44709589e-01,  3.51964058e-02],
       [ 8.49745285e-01,  3.42884835e-02],
       [ 8.54780250e-01,  3.33767181e-02],
       [ 8.59814401e-01,  3.24606418e-02],
       [ 8.64847654e-01,  3.15397862e-02],
       [ 8.69879926e-01,  3.06136835e-02],
       [ 8.74911134e-01,  2.96818655e-02],
       [ 8.79941194e-01,  2.87438641e-02],
       [ 8.84970021e-01,  2.77992112e-02],
       [ 8.89997534e-01,  2.68474389e-02],
       [ 8.95023648e-01,  2.58880789e-02],
       [ 9.00048280e-01,  2.49206633e-02],
       [ 9.05071333e-01,  2.39447033e-02],
       [ 9.10092660e-01,  2.29596307e-02],
       [ 9.15112102e-01,  2.19648577e-02],
       [ 9.20129501e-01,  2.09597964e-02],
       [ 9.25144696e-01,  1.99438592e-02],
       [ 9.30157529e-01,  1.89164582e-02],
       [ 9.35167840e-01,  1.78770056e-02],
       [ 9.40175471e-01,  1.68249138e-02],
       [ 9.45180262e-01,  1.57595950e-02],
       [ 9.50182053e-01,  1.46804613e-02],
       [ 9.55180687e-01,  1.35869250e-02],
       [ 9.60176002e-01,  1.24783984e-02],
       [ 9.65167842e-01,  1.13542936e-02],
       [ 9.70156045e-01,  1.02140229e-02],
       [ 9.75140454e-01,  9.05699861e-03],
       [ 9.80120908e-01,  7.88263283e-03],
       [ 9.85097249e-01,  6.69033785e-03],
       [ 9.90069317e-01,  5.47952590e-03],
       [ 9.95036954e-01,  4.24960921e-03],
       [ 1.00000000e+00,  3.00000000e-03]]

P = [[6.54330915e+00, 9.63811558e-04], [9.63811558e-04, 1.17710681e+00]]
D = [[6.52666623, 0.02468094], [0.02468094, 1.1104877 ]]
S = [[6.52176552, 0.03485806], [0.03485806, 1.09417461]]
vector = [[-0.06786603,  0.02029431], [ 0.02029431,  0.09092832]]

class Test(TestCase):

    def test_log_exp(self):
        # check Exp(Log)
        direction = log(S, D)
        new_D = exp(1, S, direction)
        np.testing.assert_almost_equal(D, new_D, decimal=10, err_msg='', verbose=True)
        #check Log(Exp)
        D1 = exp(1, P, vector)
        new_vector = log(P, D1)
        np.testing.assert_almost_equal(vector, new_vector, decimal=10, err_msg='', verbose=True)

    def test_polar_decomposition(self):

        # single shape
        shapes_gr, P, b = polar_decomposition(X_phys)
        new_X = shapes_gr @ P + b
        np.testing.assert_almost_equal(X_phys, new_X, decimal=10, err_msg='', verbose=True)

        # array of shapes
        shapes = np.vstack((X_phys, Y_phys))
        shapes_gr, P, b = polar_decomposition(shapes)
        new_shapes = shapes_gr @ P + b
        np.testing.assert_almost_equal(shapes, new_shapes, decimal=10, err_msg='', verbose=True)

        #TODO: check orthonormality of columns
